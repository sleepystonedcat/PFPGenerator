<!DOCTYPE html>
<html lang="en">
<head>
  <link rel="icon" href="favicon.ico" type="image/x-icon">
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SLEEPY•STONED•CAT</title>
<link rel="stylesheet" href="https://unpkg.com/98.css">
<style>
  body {
      -webkit-user-select: none; /* Safari */
  -ms-user-select: none; /* IE 10 and IE 11 */
  user-select: none; /* Standard syntax */
    font-family: Arial, sans-serif;
    text-align: center;
    background: url('https://web.archive.org/web/20091027034121/http://www.geocities.com/jessdchick/BACKGROUNDanimatedchangingcolorstars.gif') repeat;
  }
  #container {
    display: flex;
    flex-direction: column;
    align-items: center;
    margin-top: 20px;

  }
  .window {

  flex-direction: column;
  align-items: center;

}
  .window title-bar {
    display: flex;
    flex-direction: column;
    align-items: center;
  }
  #canvas {
    border: 1px solid #000;
    cursor: default;
  }
  #sliderContainer {
    display: none;
    margin-top: 20px;
  }
  #slider {
    width: 300px;
  }
#bottom-container {
  position: fixed;
  bottom: 10px; /* Adjust this value */
  left: 50%;
  transform: translateX(-50%);
  /* Other styles (e.g., width, background color) go here */
}

</style>
</head>
<body>
  <img src="https://files.catbox.moe/cfd63d.gif">

  <br><br>
  <div id="container">
    <div class="window">
      <div class="title-bar">
        <div class="title-bar-text">PFP Generator v1.0</div>
      </div>
      <div class="window-body">
        <fieldset>
          <label for="upload">Upload Background Image:</label>
          <input type="file" id="upload" class="input-file" accept="image/*">
        </fieldset>
        <br>
        <button id="overlayBtn" class="button" disabled>Add $Sleepy Cat</button>
        <br><br>
        <canvas id="canvas"></canvas>
        <div id="sliderContainer">
       <p>Drag the cat around with your mouse!</p>

          <label for="slider">Resize Sleepy Cat</label>
          <input type="range" id="slider" min="10" max="200" value="100">
                  <br><br>
                  <button id="saveBtn" class="button" disabled>Save Image</button>
        <br><br>
        </div>
      </div>
    </div>
  </div>
  
  
  <br>
  <div id="bottom-container">
    <div class="window">
      <div class="title-bar">
        <div class="title-bar-text">OFFICIAL LINKS</div>
      </div>
      <div class="window-body">
        <fieldset>
          <p><b>Socials:</b></p>
          Telegram: <a href="https://t.me/SLEEPYSTONEDCAT" target="_blank">t.me/SLEEPYSTONEDCAT</a><br><br>
          Twitter: <a href="https://x.com/SLEEPYSTONEDCAT" target="_blank">x.com/SLEEPYSTONEDCAT</a>
          <br><br><br>
        </fieldset>
        <br>
        <fieldset>
          <marquee>BUY $SLEEPY</marquee>
          <p><b>Secondary:</b></p>
          <a href="https://magiceden.io/runes/SLEEPY%E2%80%A2STONED%E2%80%A2CAT" target="_blank">MagicEden</a><br><br>
          <a href="https://unisat.io/runes/market?tick=SLEEPY%E2%80%A2STONED%E2%80%A2CAT" target="_blank">Unisat</a><br><br>
          <a href="https://www.okx.com/web3/marketplace/runes/token/SLEEPY%E2%80%A2STONED%E2%80%A2CAT/848624:2006" target="_blank">OKX</a><br><br>
          <marquee direction="right">BUY $SLEEPY</marquee>
        </fieldset>
      </div>
    </div>
  </div>
  <script>
    const uploadInput = document.getElementById('upload');
    const overlayBtn = document.getElementById('overlayBtn');
    const saveBtn = document.getElementById('saveBtn');
    const canvas = document.getElementById('canvas');
    const ctx = canvas.getContext('2d');
    const sliderContainer = document.getElementById('sliderContainer');
    const slider = document.getElementById('slider');
    const windowElement = document.querySelector('.window');

    let backgroundImage = null;
    let overlayImage = null;
    let isDragging = false;
    let startX, startY, startWidth, startHeight;
    let overlayX, overlayY, overlayWidth, overlayHeight;

    uploadInput.addEventListener('change', handleUpload);
    overlayBtn.addEventListener('click', handleOverlay);
    slider.addEventListener('input', resizeOverlay);
    saveBtn.addEventListener('click', saveImage);

    function handleUpload(event) {
      const file = event.target.files[0];
      if (file && file.type.startsWith('image/')) {
        const reader = new FileReader();
        reader.onload = function(e) {
          backgroundImage = new Image();
          backgroundImage.onload = function() {
            canvas.width = backgroundImage.width;
            canvas.height = backgroundImage.height;
            ctx.drawImage(backgroundImage, 0, 0);
            overlayBtn.disabled = false;
            updateWindowSize(backgroundImage.width, backgroundImage.height);
          };
          backgroundImage.src = e.target.result;
        };
        reader.readAsDataURL(file);
      }
    }

function handleOverlay() {
  const overlaySrc = 'https://i.imgur.com/bZT8j45.png'; 
  overlayImage = new Image();
  overlayImage.crossOrigin = "anonymous"; 
  overlayImage.onload = function() {
        const scale = Math.min(
          canvas.width / overlayImage.width,
          canvas.height / overlayImage.height
        );
        overlayWidth = overlayImage.width * scale;
        overlayHeight = overlayImage.height * scale;
        overlayX = (canvas.width - overlayWidth) / 2;
        overlayY = (canvas.height - overlayHeight) / 2; 
        redrawOverlay();
        sliderContainer.style.display = 'block';
        enableDragging();
        saveBtn.disabled = false; // enable the save button
      };
      overlayImage.src = overlaySrc;
    }

    function resizeOverlay() {
      const scale = slider.value / 100;
      overlayWidth = overlayImage.width * scale;
      overlayHeight = overlayImage.height * scale;
      redrawOverlay();
    }

function saveImage() {
  const dataUrl = canvas.toDataURL('image/png');
  const link = document.createElement('a');
  link.href = dataUrl;
  link.download = 'image.png';
  document.body.appendChild(link);
  link.click(); 
  document.body.removeChild(link);
}

    function enableDragging() {
      function startDrag(e) {
        if (isMouseOnOverlay(e)) {
          isDragging = true;
          startX = e.offsetX || e.touches[0].clientX;
          startY = e.offsetY || e.touches[0].clientY;
          canvas.style.cursor = 'move';
        }
      }

      function drag(e) {
        if (isDragging) {
          const offsetX = (e.offsetX || e.touches[0].clientX) - startX;
          const offsetY = (e.offsetY || e.touches[0].clientY) - startY;
          overlayX += offsetX;
          overlayY += offsetY;
          redrawOverlay();
          startX = e.offsetX || e.touches[0].clientX;
          startY = e.offsetY || e.touches[0].clientY;
        }
      }

      function endDrag() {
        isDragging = false;
        canvas.style.cursor = 'default';
      }

      canvas.addEventListener('mousedown', startDrag);
      canvas.addEventListener('mousemove', drag);
      canvas.addEventListener('mouseup', endDrag);

      // Add touch event listeners
      canvas.addEventListener('touchstart', startDrag);
      canvas.addEventListener('touchmove', drag);
      canvas.addEventListener('touchend', endDrag);
    }

    function redrawOverlay() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      ctx.drawImage(backgroundImage, 0, 0);
      ctx.drawImage(overlayImage, overlayX, overlayY, overlayWidth, overlayHeight);
    }

    function isMouseOnOverlay(e) {
      return e.offsetX >= overlayX && e.offsetX <= overlayX + overlayWidth &&
             e.offsetY >= overlayY && e.offsetY <= overlayY + overlayHeight;
    }

    function updateWindowSize(imgWidth, imgHeight) {
      windowElement.style.width = `${imgWidth + 40}px`; 
      windowElement.style.height = `${imgHeight + 250}px`; 
    }
    
  </script>
</body>
</html>
